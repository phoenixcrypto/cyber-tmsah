# ุฏููู ุญุฐู ุฌููุน ุงูุทูุงุจ - Delete All Students Guide

## โ๏ธ ุชุญุฐูุฑ ููู

ูุฐุง ุงูุณูุฑูุจุช ุณูุญุฐู **ุฌููุน ุงูุทูุงุจ ุงููุณุฌููู** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. ุชุฃูุฏ ูู ุฃูู ุชุฑูุฏ ุงูููุงู ุจุฐูู ูุจู ุงูุชูููุฐ.

---

## ๐ ุงูุฎุทูุงุช

### 1. ุงูุชุญ Supabase SQL Editor

1. ุงุฐูุจ ุฅูู [Supabase Dashboard](https://supabase.com/dashboard)
2. ุงุฎุชุฑ ูุดุฑูุนู
3. ุงุฐูุจ ุฅูู **SQL Editor** ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ

### 2. ุงูุณุฎ ูุงูุตู ุงูุณูุฑูุจุช ุงูุชุงูู

```sql
-- ============================================
-- Delete All Students Script
-- ุญุฐู ุฌููุน ุงูุทูุงุจ ุงููุณุฌููู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
-- ============================================

-- Step 1: Delete ALL students (keep admins)
-- ุงูุฎุทูุฉ 1: ุญุฐู ุฌููุน ุงูุทูุงุจ (ุงูุงุญุชูุงุธ ุจู Admin)
DELETE FROM users WHERE role = 'student';

-- Step 2: Reset verification list registration status
-- ุงูุฎุทูุฉ 2: ุฅุนุงุฏุฉ ุชุนููู ุญุงูุฉ ุงูุชุณุฌูู ูู ูุงุฆูุฉ ุงูุชุญูู
UPDATE verification_list 
SET 
  is_registered = FALSE,
  registered_at = NULL,
  registered_by = NULL,
  updated_at = NOW()
WHERE is_registered = TRUE;

-- Step 3: Verify deletion
-- ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู ุงูุญุฐู
SELECT 
  role,
  COUNT(*) as count
FROM users
GROUP BY role;

-- Step 4: Show remaining users
-- ุงูุฎุทูุฉ 4: ุนุฑุถ ุงููุณุชุฎุฏููู ุงููุชุจููู
SELECT 
  id,
  username,
  email,
  full_name,
  role,
  is_active,
  created_at
FROM users
ORDER BY created_at DESC;
```

### 3. ุดุบูู ุงูุณูุฑูุจุช

1. ุงุถุบุท ุนูู **Run** ุฃู **Execute**
2. ุงูุชุธุฑ ุญุชู ููุชูู ุงูุชูููุฐ
3. ุชุญูู ูู ุงููุชุงุฆุฌ

---

## โ ุงูุชุญูู ูู ุงููุชุงุฆุฌ

ุจุนุฏ ุชูููุฐ ุงูุณูุฑูุจุชุ ูุฌุจ ุฃู ุชุฑู:

1. **ุนุฏุฏ ุงููุณุชุฎุฏููู ุญุณุจ Role:**
   - `admin`: 1 (ุฃู ุฃูุซุฑ ุฅุฐุง ูุงู ูุฏูู ุฃูุซุฑ ูู admin)
   - `student`: 0

2. **ูุงุฆูุฉ ุงููุณุชุฎุฏููู ุงููุชุจููู:**
   - ูุฌุจ ุฃู ุชุฑู ููุท Admin accounts
   - ูุง ูุฌุจ ุฃู ุชุฑู ุฃู ุทูุงุจ

3. **ูุงุฆูุฉ ุงูุชุญูู:**
   - ุฌููุน ุงูุทูุงุจ ูู `verification_list` ูุฌุจ ุฃู ูููู `is_registered = FALSE`

---

## ๐ ุงูุจุฏุก ูู ุฌุฏูุฏ

ุจุนุฏ ุญุฐู ุฌููุน ุงูุทูุงุจ:

1. โ ุฌููุน ุงูุทูุงุจ ุชู ุญุฐููู ูู `users` table
2. โ ุฌููุน ุงูุทูุงุจ ูู `verification_list` ุฃุตุจุญูุง `is_registered = FALSE`
3. โ ูููู ููุทูุงุจ ุงูุชุณุฌูู ูู ุฌุฏูุฏ

---

## ๐ ููุงุญุธุงุช

### ุฅุฐุง ุฃุฑุฏุช ุญุฐู ุทูุงุจ ูุญุฏุฏูู ููุท:

```sql
-- ุญุฐู ุทูุงุจ ูุณู ูุนูู
DELETE FROM users 
WHERE role = 'student' AND section_number = 5;

-- ุญุฐู ุทูุงุจ ุบูุฑ ูุดุทูู ููุท
DELETE FROM users 
WHERE role = 'student' AND is_active = FALSE;
```

### ุฅุฐุง ุฃุฑุฏุช ุญุฐู ุฌููุน ุงููุณุชุฎุฏููู (ุจูุง ูู ุฐูู Admin):

```sql
-- โ๏ธ ุชุญุฐูุฑ: ูุฐุง ุณูุญุฐู Admin ุฃูุถุงู!
DELETE FROM users;
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "Error: permission denied"
**ุงูุญู:** ุชุฃูุฏ ูู ุฃูู ุชุณุชุฎุฏู Service Role Key ุฃู ุฃู ูุฏูู ุตูุงุญูุงุช ูุงููุฉ

### ุงููุดููุฉ: "Error: foreign key constraint"
**ุงูุญู:** ูุฏ ูููู ููุงู ุฌุฏุงูู ุฃุฎุฑู ูุฑุชุจุทุฉ ุจู `users`. ุชุญูู ูู ุงูุนูุงูุงุช (Foreign Keys)

---

**ุขุฎุฑ ุชุญุฏูุซ:** $(date)
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู

